<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Todoyu: TodoyuDaytracksHistoryManager Klassenreferenz</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Erzeugt von Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Hauptseite</span></a></li>
      <li><a href="pages.html"><span>Zusätzliche&nbsp;Informationen</span></a></li>
      <li><a href="namespaces.html"><span>Namensbereiche</span></a></li>
      <li class="current"><a href="annotated.html"><span>Datenstrukturen</span></a></li>
      <li><a href="files.html"><span>Dateien</span></a></li>
      <li><a href="examples.html"><span>Beispiele</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Datenstrukturen</span></a></li>
      <li><a href="hierarchy.html"><span>Klassenhierarchie</span></a></li>
      <li><a href="functions.html"><span>Datenstruktur-Elemente</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>TodoyuDaytracksHistoryManager Klassenreferenz</h1><!-- doxytag: class="TodoyuDaytracksHistoryManager" --><table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Öffentliche, statische Methoden</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_todoyu_daytracks_history_manager.html#a0631f17ca4c1c7bf4d19a025c63ba45a">getTrackingRanges</a> ($idUser=0)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_todoyu_daytracks_history_manager.html#ac46722daa417cd5ca2b8498bba719592">getMonthSelectorOptions</a> ($idUser=0)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_todoyu_daytracks_history_manager.html#a12ba5363cc50485248385f241293ee7e">getRangeTracks</a> ($year, $month, $details=false, $idUser=0)</td></tr>
<tr><td colspan="2"><h2>Datenfelder</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_todoyu_daytracks_history_manager.html#adf62e2b172196282218b1ece3d200fa1">TABLE</a> = 'ext_timetracking_track'</td></tr>
</table>
<hr/><a name="_details"></a><h2>Ausführliche Beschreibung</h2>

<p>Definiert in Zeile <a class="el" href="_todoyu_daytracks_history_manager_8class_8php_source.html#l00028">28</a> der Datei <a class="el" href="_todoyu_daytracks_history_manager_8class_8php_source.html">TodoyuDaytracksHistoryManager.class.php</a>.</p>
<hr/><h2>Dokumentation der Elementfunktionen</h2>
<a class="anchor" id="ac46722daa417cd5ca2b8498bba719592"></a><!-- doxytag: member="TodoyuDaytracksHistoryManager::getMonthSelectorOptions" ref="ac46722daa417cd5ca2b8498bba719592" args="($idUser=0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static getMonthSelectorOptions </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>idUser</em> = <code>0</code></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get data array for the range selector in the history popup The years are the keys, the month the subelements of each year The range is starts at the first tracking, and ends at the last</p>
<dl><dt><b>Parameter:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Integer</em>&nbsp;</td><td>$idUser </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Rückgabe:</b></dt><dd>Array </dd></dl>

<p>Definiert in Zeile <a class="el" href="_todoyu_daytracks_history_manager_8class_8php_source.html#l00069">69</a> der Datei <a class="el" href="_todoyu_daytracks_history_manager_8class_8php_source.html">TodoyuDaytracksHistoryManager.class.php</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00069"></a>00069                                                                 {
<a name="l00070"></a>00070         $range  = <a class="code" href="class_todoyu_daytracks_history_manager.html#a0631f17ca4c1c7bf4d19a025c63ba45a">self::getTrackingRanges</a>($idUser);
<a name="l00071"></a>00071         $options= array();
<a name="l00072"></a>00072 
<a name="l00073"></a>00073         $current= $range[<span class="stringliteral">&apos;min&apos;</span>];
<a name="l00074"></a>00074 
<a name="l00075"></a>00075         <span class="keywordflow">while</span>( $current &lt;= $range[<span class="stringliteral">&apos;max&apos;</span>] ) {
<a name="l00076"></a>00076             $year   = date(<span class="charliteral">&apos;Y&apos;</span>, $current);
<a name="l00077"></a>00077             $month  = date(<span class="charliteral">&apos;n&apos;</span>, $current);
<a name="l00078"></a>00078 
<a name="l00079"></a>00079             $options[$year][$month] = <a class="code" href="functions_8php.html#a7c072b45376ab4eab800bc4788a4e22f">Label</a>(<span class="stringliteral">&apos;date.month.&apos;</span> . strtolower(date(<span class="charliteral">&apos;F&apos;</span>, $current)));
<a name="l00080"></a>00080 
<a name="l00081"></a>00081             <span class="keywordflow">if</span>( $month === 12 ) {
<a name="l00082"></a>00082                 $month  = 1;
<a name="l00083"></a>00083                 $year   += 1;
<a name="l00084"></a>00084             } <span class="keywordflow">else</span> {
<a name="l00085"></a>00085                 $month++;
<a name="l00086"></a>00086             }
<a name="l00087"></a>00087 
<a name="l00088"></a>00088             $current = mktime(0, 0, 0, $month, 1, $year);
<a name="l00089"></a>00089         }
<a name="l00090"></a>00090 
<a name="l00091"></a>00091         <span class="keywordflow">return</span> $options;
<a name="l00092"></a>00092     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a12ba5363cc50485248385f241293ee7e"></a><!-- doxytag: member="TodoyuDaytracksHistoryManager::getRangeTracks" ref="a12ba5363cc50485248385f241293ee7e" args="($year, $month, $details=false, $idUser=0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static getRangeTracks </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>year</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>month</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>details</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>idUser</em> = <code>0</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get all tracks in a range for a user The tracks are grouped by day and already summed up in the total key</p>
<dl><dt><b>Parameter:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Integer</em>&nbsp;</td><td>$year </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Integer</em>&nbsp;</td><td>$month </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Bool</em>&nbsp;</td><td>$details </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Integer</em>&nbsp;</td><td>$idUser </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Rückgabe:</b></dt><dd>Array </dd></dl>

<p>Definiert in Zeile <a class="el" href="_todoyu_daytracks_history_manager_8class_8php_source.html#l00106">106</a> der Datei <a class="el" href="_todoyu_daytracks_history_manager_8class_8php_source.html">TodoyuDaytracksHistoryManager.class.php</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00106"></a>00106                                                                                         {
<a name="l00107"></a>00107         $year       = intval($year);
<a name="l00108"></a>00108         $month      = intval($month);
<a name="l00109"></a>00109         $idUser     = <a class="code" href="functions_8php.html#acd1b461c014cc991f4890c41b9e9375b">userid</a>($idUser);
<a name="l00110"></a>00110         $dateStart  = mktime(0, 0, 0, $month, 1, $year);
<a name="l00111"></a>00111         $dateEnd    = mktime(0, 0, 0, $month+1, 1, $year)-1;
<a name="l00112"></a>00112 
<a name="l00113"></a>00113 
<a name="l00114"></a>00114         $tracks     = <a class="code" href="class_todoyu_timetracking.html#a616eb3c35c215b1df41ac68919de871b">TodoyuTimetracking::getUserTracks</a>($dateStart, $dateEnd, $idUser);
<a name="l00115"></a>00115 
<a name="l00116"></a>00116         <a class="code" href="daily__workload_8php.html#afbd634f3e58d9cdbe3f69cc9f54a5a1b">$workloads</a>  = <a class="code" href="class_todoyu_array.html#ad2c7a0fa47bdfe76e832d0145aecbc20">TodoyuArray::getColumn</a>($tracks, <span class="stringliteral">&apos;workload_tracked&apos;</span>);
<a name="l00117"></a>00117         $total      = array_sum(<a class="code" href="daily__workload_8php.html#afbd634f3e58d9cdbe3f69cc9f54a5a1b">$workloads</a>);
<a name="l00118"></a>00118         $tracksByDay= array();
<a name="l00119"></a>00119 
<a name="l00120"></a>00120         <span class="keywordflow">foreach</span>($tracks as $track) {
<a name="l00121"></a>00121             $timestamp  = <a class="code" href="class_todoyu_time.html#a7a1884c9388ce7eec592af5191304392">TodoyuTime::getStartOfDay</a>($track[<span class="stringliteral">&apos;date_create&apos;</span>]);
<a name="l00122"></a>00122 
<a name="l00123"></a>00123             $tracksByDay[$timestamp][<span class="stringliteral">&apos;tracks&apos;</span>][]    = $track;
<a name="l00124"></a>00124             $tracksByDay[$timestamp][<span class="stringliteral">&apos;total&apos;</span>]       += $track[<span class="stringliteral">&apos;workload_tracked&apos;</span>];
<a name="l00125"></a>00125         }
<a name="l00126"></a>00126 
<a name="l00127"></a>00127 
<a name="l00128"></a>00128 
<a name="l00129"></a>00129         <span class="keywordflow">if</span>( $details ) {
<a name="l00130"></a>00130             <span class="keywordflow">foreach</span>($tracksByDay as $timestamp =&gt; $dayTracks) {
<a name="l00131"></a>00131                 <span class="keywordflow">foreach</span>($dayTracks[<span class="stringliteral">&apos;tracks&apos;</span>] as $index =&gt; $track) {
<a name="l00132"></a>00132                     $tracksByDay[$timestamp][<span class="stringliteral">&apos;tracks&apos;</span>][$index][<span class="stringliteral">&apos;task&apos;</span>] = <a class="code" href="class_todoyu_task_manager.html#aa803ff123ea1cb2b53ff7107bcd3ec35">TodoyuTaskManager::getTaskArray</a>($track[<span class="stringliteral">&apos;id_task&apos;</span>]);
<a name="l00133"></a>00133                 }
<a name="l00134"></a>00134             }
<a name="l00135"></a>00135         }
<a name="l00136"></a>00136 
<a name="l00137"></a>00137         <span class="keywordflow">return</span> array(
<a name="l00138"></a>00138             <span class="stringliteral">&apos;dateStart&apos;</span> =&gt; $dateStart,
<a name="l00139"></a>00139             <span class="stringliteral">&apos;dateEnd&apos;</span>   =&gt; $dateEnd,
<a name="l00140"></a>00140             <span class="stringliteral">&apos;total&apos;</span>     =&gt; $total,
<a name="l00141"></a>00141             <span class="stringliteral">&apos;dayTracks&apos;</span> =&gt; $tracksByDay
<a name="l00142"></a>00142         );
<a name="l00143"></a>00143     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0631f17ca4c1c7bf4d19a025c63ba45a"></a><!-- doxytag: member="TodoyuDaytracksHistoryManager::getTrackingRanges" ref="a0631f17ca4c1c7bf4d19a025c63ba45a" args="($idUser=0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static getTrackingRanges </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>idUser</em> = <code>0</code></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get the date of the first and the last tracking</p>
<dl><dt><b>Parameter:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Integer</em>&nbsp;</td><td>$idUser </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Rückgabe:</b></dt><dd>Array [min,max] </dd></dl>

<p>Definiert in Zeile <a class="el" href="_todoyu_daytracks_history_manager_8class_8php_source.html#l00044">44</a> der Datei <a class="el" href="_todoyu_daytracks_history_manager_8class_8php_source.html">TodoyuDaytracksHistoryManager.class.php</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00044"></a>00044                                                           {
<a name="l00045"></a>00045         $idUser = <a class="code" href="functions_8php.html#acd1b461c014cc991f4890c41b9e9375b">userid</a>($idUser);
<a name="l00046"></a>00046         <a class="code" href="daily__workload_8php.html#ab2303c817e3b402b77b7f99627b9c319">$fields</a> = <span class="stringliteral">&apos; MIN(&apos;</span> . <a class="code" href="class_todoyu.html#abf2dfcff06cad1e6c249ddc4df4d0866">Todoyu::db</a>()-&gt;backtick(<span class="stringliteral">&apos;date_create&apos;</span>) . <span class="stringliteral">&apos;) as &apos;</span> . <a class="code" href="class_todoyu.html#abf2dfcff06cad1e6c249ddc4df4d0866">Todoyu::db</a>()-&gt;backtick(<span class="stringliteral">&apos;min&apos;</span>) . <span class="stringliteral">&apos;,</span>
<a name="l00047"></a>00047 <span class="stringliteral">                    MAX(&apos;</span> . <a class="code" href="class_todoyu.html#abf2dfcff06cad1e6c249ddc4df4d0866">Todoyu::db</a>()-&gt;backtick(<span class="stringliteral">&apos;date_create&apos;</span>) . <span class="stringliteral">&apos;) as &apos;</span> . <a class="code" href="class_todoyu.html#abf2dfcff06cad1e6c249ddc4df4d0866">Todoyu::db</a>()-&gt;backtick(<span class="stringliteral">&apos;max&apos;</span>);
<a name="l00048"></a>00048         <a class="code" href="acknowledged__after_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>  = self::TABLE;
<a name="l00049"></a>00049         <a class="code" href="acknowledged__after_8php.html#aa2080b85972946a82a6ec215a34f7d69">$where</a>  = <span class="stringliteral">&apos;id_user = &apos;</span> . $idUser;
<a name="l00050"></a>00050 
<a name="l00051"></a>00051         $result = <a class="code" href="class_todoyu.html#abf2dfcff06cad1e6c249ddc4df4d0866">Todoyu::db</a>()-&gt;getRecordByQuery(<a class="code" href="daily__workload_8php.html#ab2303c817e3b402b77b7f99627b9c319">$fields</a>, <a class="code" href="acknowledged__after_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>, <a class="code" href="acknowledged__after_8php.html#aa2080b85972946a82a6ec215a34f7d69">$where</a>);
<a name="l00052"></a>00052 
<a name="l00053"></a>00053         <span class="keywordflow">return</span> array(
<a name="l00054"></a>00054             <span class="stringliteral">&apos;min&apos;</span>   =&gt; intval($result[<span class="stringliteral">&apos;min&apos;</span>]),
<a name="l00055"></a>00055             <span class="stringliteral">&apos;max&apos;</span>   =&gt; intval($result[<span class="stringliteral">&apos;max&apos;</span>])
<a name="l00056"></a>00056         );
<a name="l00057"></a>00057     }
</pre></div></p>

</div>
</div>
<hr/><h2>Dokumentation der Datenelemente</h2>
<a class="anchor" id="adf62e2b172196282218b1ece3d200fa1"></a><!-- doxytag: member="TodoyuDaytracksHistoryManager::TABLE" ref="adf62e2b172196282218b1ece3d200fa1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_todoyu_daytracks_history_manager.html#adf62e2b172196282218b1ece3d200fa1">TABLE</a> = 'ext_timetracking_track'</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Database table </p>

<p>Definiert in Zeile <a class="el" href="_todoyu_daytracks_history_manager_8class_8php_source.html#l00034">34</a> der Datei <a class="el" href="_todoyu_daytracks_history_manager_8class_8php_source.html">TodoyuDaytracksHistoryManager.class.php</a>.</p>

</div>
</div>
<hr/>Die Dokumentation für diese Klasse wurde erzeugt aufgrund der Datei:<ul>
<li>C:/Programme/xampp/htdocs/todoyu2/ext/daytracks/model/<a class="el" href="_todoyu_daytracks_history_manager_8class_8php_source.html">TodoyuDaytracksHistoryManager.class.php</a></li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>Erzeugt am Tue Dec 1 18:32:44 2009 für Todoyu von&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
