<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Todoyu: TodoyuOdt Klassenreferenz</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Erzeugt von Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Hauptseite</span></a></li>
      <li><a href="pages.html"><span>Zusätzliche&nbsp;Informationen</span></a></li>
      <li><a href="namespaces.html"><span>Namensbereiche</span></a></li>
      <li class="current"><a href="annotated.html"><span>Datenstrukturen</span></a></li>
      <li><a href="files.html"><span>Dateien</span></a></li>
      <li><a href="examples.html"><span>Beispiele</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Datenstrukturen</span></a></li>
      <li><a href="hierarchy.html"><span>Klassenhierarchie</span></a></li>
      <li><a href="functions.html"><span>Datenstruktur-Elemente</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>TodoyuOdt Klassenreferenz</h1><!-- doxytag: class="TodoyuOdt" --><table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Öffentliche Methoden</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_todoyu_odt.html#a5102c7c8a8b0e789dcff913e0781a260">__construct</a> ($ext= 'unknown', $newFileName= 'unknown.odt')</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_todoyu_odt.html#a03cb9db6e8b76566e472612d14550a05">openFromTemplate</a> ($templateFile)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_todoyu_odt.html#ac756f1b67954f30d187e1c82a38a1898">replaceMarkers</a> (array $markersArray)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_todoyu_odt.html#a00bf95c4d461199f209c19aa2c391564">replaceMarker</a> ($markerName, $value, $content)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_todoyu_odt.html#a9422368b3447d2e775fd11b33b44c7a2">download</a> ()</td></tr>
<tr><td colspan="2"><h2>Geschützte Methoden</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_todoyu_odt.html#a4be4055f3361d4800e16bc2e2e38cda6">init</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_todoyu_odt.html#a269b9025a53d7214c6705b898600c8e3">extractTableFromDocument</a> ($document, $number=1, $keepContentBeforeTable=false)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_todoyu_odt.html#abf50d1caf70abd39e10d6c41715b3177">extractRowFromTable</a> ($table, $which=1)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_todoyu_odt.html#af93f3adb8717fce28ce679a70ef5726b">getTemplateFileName</a> ($tmplFile)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_todoyu_odt.html#ae3e046155ccc09aa7fc6eb2aa5af04d8">write</a> ($odtPath=null)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_todoyu_odt.html#a58e43f09a06ce4e29b192c4e17ce7915">getContent</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_todoyu_odt.html#aa69c8bf1f1dcf4e72552efff1fe3e87e">close</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_todoyu_odt.html#ac97c6499e6c8221c2199651017d9cefe">compressToZip</a> ($destination, $source)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_todoyu_odt.html#a211a228d0801e7661acbee96a1a57df5">extractFromZip</a> ($destination, $source)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_todoyu_odt.html#a840b738964f8750ed1e97b94ae3535cb">exec</a> ($command)</td></tr>
<tr><td colspan="2"><h2>Geschützte Attribute</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_todoyu_odt.html#aee4c6edab40be8352c6f5aa453437f6b">$tmpDir</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_todoyu_odt.html#a42cf7a1034adc5fef0c8d89f6300189d">$tmpOdtDir</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_todoyu_odt.html#a236ef5b2a05f6aac010d313fec700d97">$tmpOdtFile</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_todoyu_odt.html#ade30ae71930839daaf6f83bd19081493">$ext</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Ausführliche Beschreibung</h2>
<p>This class handles odt files </p>

<p>Definiert in Zeile <a class="el" href="_todoyu_odt_8class_8php_source.html#l00026">26</a> der Datei <a class="el" href="_todoyu_odt_8class_8php_source.html">TodoyuOdt.class.php</a>.</p>
<hr/><h2>Beschreibung der Konstruktoren und Destruktoren</h2>
<a class="anchor" id="a5102c7c8a8b0e789dcff913e0781a260"></a><!-- doxytag: member="TodoyuOdt::__construct" ref="a5102c7c8a8b0e789dcff913e0781a260" args="($ext= 'unknown', $newFileName= 'unknown.odt')" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__construct </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>ext</em> = <code>'unknown'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>newFileName</em> = <code>'unknown.odt'</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Constructor of the class</p>
<dl><dt><b>Parameter:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>String</em>&nbsp;</td><td>$ext </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>String</em>&nbsp;</td><td>$newFileName </td></tr>
  </table>
  </dd>
</dl>

<p>Definiert in Zeile <a class="el" href="_todoyu_odt_8class_8php_source.html#l00072">72</a> der Datei <a class="el" href="_todoyu_odt_8class_8php_source.html">TodoyuOdt.class.php</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00072"></a>00072                                                                                 {
<a name="l00073"></a>00073         $this-&gt;tmpDir       = <a class="code" href="core_2config_2constants_8php.html#a493cb31434fe89068acb376025bd7c7b">PATH_CACHE</a>.<span class="stringliteral">&apos;/odt&apos;</span>;
<a name="l00074"></a>00074         $this-&gt;ext          = <a class="code" href="class_todoyu_odt.html#ade30ae71930839daaf6f83bd19081493">$ext</a>;
<a name="l00075"></a>00075         $this-&gt;newFileName  = $newFileName;
<a name="l00076"></a>00076 
<a name="l00077"></a>00077         $this-&gt;<a class="code" href="class_todoyu_odt.html#a4be4055f3361d4800e16bc2e2e38cda6">init</a>();
<a name="l00078"></a>00078     }
</pre></div></p>

</div>
</div>
<hr/><h2>Dokumentation der Elementfunktionen</h2>
<a class="anchor" id="aa69c8bf1f1dcf4e72552efff1fe3e87e"></a><!-- doxytag: member="TodoyuOdt::close" ref="aa69c8bf1f1dcf4e72552efff1fe3e87e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">close </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>removes the temporary added folders and files </p>

<p>Definiert in Zeile <a class="el" href="_todoyu_odt_8class_8php_source.html#l00296">296</a> der Datei <a class="el" href="_todoyu_odt_8class_8php_source.html">TodoyuOdt.class.php</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00296"></a>00296                                 {
<a name="l00297"></a>00297         $command = <span class="stringliteral">&apos;rm -R &apos;</span> . $this-&gt;tmpOdtDir;
<a name="l00298"></a>00298         $this-&gt;<a class="code" href="class_todoyu_odt.html#a840b738964f8750ed1e97b94ae3535cb">exec</a>($command);
<a name="l00299"></a>00299         $command = <span class="stringliteral">&apos;rm &apos;</span>. $this-&gt;tmpOdtFile;
<a name="l00300"></a>00300         $this-&gt;<a class="code" href="class_todoyu_odt.html#a840b738964f8750ed1e97b94ae3535cb">exec</a>($command);
<a name="l00301"></a>00301     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac97c6499e6c8221c2199651017d9cefe"></a><!-- doxytag: member="TodoyuOdt::compressToZip" ref="ac97c6499e6c8221c2199651017d9cefe" args="($destination, $source)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">compressToZip </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>destination</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>source</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Compresses files from source to destination</p>
<dl><dt><b>Parameter:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>String</em>&nbsp;</td><td>$destination </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>String</em>&nbsp;</td><td>$source </td></tr>
  </table>
  </dd>
</dl>

<p>Definiert in Zeile <a class="el" href="_todoyu_odt_8class_8php_source.html#l00313">313</a> der Datei <a class="el" href="_todoyu_odt_8class_8php_source.html">TodoyuOdt.class.php</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00313"></a>00313                                                             {
<a name="l00314"></a>00314         <span class="keywordflow">if</span>( is_dir($source) )   {
<a name="l00315"></a>00315             $command = <span class="stringliteral">&apos;cd \&apos;&apos;</span>. $source . <span class="charliteral">&apos;\&apos;</span> &amp;&amp; zip -r \<span class="stringliteral">&apos;&apos;</span>. $destination . <span class="charliteral">&apos;\&apos;</span> *<span class="stringliteral">&apos;;</span>
<a name="l00316"></a>00316 <span class="stringliteral">            $this-&gt;exec($command);</span>
<a name="l00317"></a>00317 <span class="stringliteral">        }</span>
<a name="l00318"></a>00318 <span class="stringliteral">    }</span>
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9422368b3447d2e775fd11b33b44c7a2"></a><!-- doxytag: member="TodoyuOdt::download" ref="a9422368b3447d2e775fd11b33b44c7a2" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">download </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Downloads the current odt-file </p>

<p>Definiert in Zeile <a class="el" href="_todoyu_odt_8class_8php_source.html#l00232">232</a> der Datei <a class="el" href="_todoyu_odt_8class_8php_source.html">TodoyuOdt.class.php</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00232"></a>00232                                 {
<a name="l00233"></a>00233         header(<span class="stringliteral">&apos;Content-Type: application/vnd.oasis.opendocument.text&apos;</span>);
<a name="l00234"></a>00234         header(<span class="stringliteral">&apos;Content-Disposition: attachment; filename=&apos;</span>. $this-&gt;newFileName);
<a name="l00235"></a>00235         header(<span class="stringliteral">&apos;Pragma: no-cache&apos;</span>);
<a name="l00236"></a>00236         header(<span class="stringliteral">&apos;Expires: 0&apos;</span>);
<a name="l00237"></a>00237 
<a name="l00238"></a>00238         echo $this-&gt;<a class="code" href="class_todoyu_odt.html#a58e43f09a06ce4e29b192c4e17ce7915">getContent</a>();
<a name="l00239"></a>00239 
<a name="l00240"></a>00240         $this-&gt;<a class="code" href="class_todoyu_odt.html#aa69c8bf1f1dcf4e72552efff1fe3e87e">close</a>();
<a name="l00241"></a>00241 
<a name="l00242"></a>00242         exit();
<a name="l00243"></a>00243     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a840b738964f8750ed1e97b94ae3535cb"></a><!-- doxytag: member="TodoyuOdt::exec" ref="a840b738964f8750ed1e97b94ae3535cb" args="($command)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">exec </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>command</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Proceeds the given command</p>
<dl><dt><b>Parameter:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>String</em>&nbsp;</td><td>$command </td></tr>
  </table>
  </dd>
</dl>

<p>Definiert in Zeile <a class="el" href="_todoyu_odt_8class_8php_source.html#l00341">341</a> der Datei <a class="el" href="_todoyu_odt_8class_8php_source.html">TodoyuOdt.class.php</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00341"></a>00341                                         {
<a name="l00342"></a>00342         <a class="code" href="class_todoyu_odt.html#a840b738964f8750ed1e97b94ae3535cb">exec</a>($command);
<a name="l00343"></a>00343     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a211a228d0801e7661acbee96a1a57df5"></a><!-- doxytag: member="TodoyuOdt::extractFromZip" ref="a211a228d0801e7661acbee96a1a57df5" args="($destination, $source)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">extractFromZip </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>destination</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>source</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Extreacts source to destination-folder</p>
<dl><dt><b>Parameter:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>String</em>&nbsp;</td><td>$destination </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>String</em>&nbsp;</td><td>$source </td></tr>
  </table>
  </dd>
</dl>

<p>Definiert in Zeile <a class="el" href="_todoyu_odt_8class_8php_source.html#l00328">328</a> der Datei <a class="el" href="_todoyu_odt_8class_8php_source.html">TodoyuOdt.class.php</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00328"></a>00328                                                                 {
<a name="l00329"></a>00329         <span class="keywordflow">if</span>( is_file($source) &amp;&amp; is_dir($destination) )  {
<a name="l00330"></a>00330             $command = <span class="stringliteral">&apos;unzip \&apos;&apos;</span> . $source . <span class="charliteral">&apos;\&apos;</span> -d \<span class="stringliteral">&apos;&apos;</span> . $destination. <span class="charliteral">&apos;\&apos;&apos;</span>;
<a name="l00331"></a>00331             $this-&gt;<a class="code" href="class_todoyu_odt.html#a840b738964f8750ed1e97b94ae3535cb">exec</a>($command);
<a name="l00332"></a>00332         }
<a name="l00333"></a>00333     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="abf50d1caf70abd39e10d6c41715b3177"></a><!-- doxytag: member="TodoyuOdt::extractRowFromTable" ref="abf50d1caf70abd39e10d6c41715b3177" args="($table, $which=1)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">extractRowFromTable </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>which</em> = <code>1</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Extract the Xth row from table. Default is 1 for the first row. e.g. you need a template row which is not the first, set which to x.</p>
<p>x - is allaways the number of the row.</p>
<dl><dt><b>Parameter:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>String</em>&nbsp;</td><td>$table </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Integer</em>&nbsp;</td><td>$which </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Rückgabe:</b></dt><dd>String </dd></dl>

<p>Definiert in Zeile <a class="el" href="_todoyu_odt_8class_8php_source.html#l00205">205</a> der Datei <a class="el" href="_todoyu_odt_8class_8php_source.html">TodoyuOdt.class.php</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00205"></a>00205                                                                {
<a name="l00206"></a>00206         $approach = <a class="code" href="acknowledged__after_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>; <span class="comment">// $approach always is the &quot;approach&quot; to the searched: the table row</span>
<a name="l00207"></a>00207 
<a name="l00208"></a>00208             <span class="comment">// take all what&apos;s not AFTER the header-rows</span>
<a name="l00209"></a>00209         $approach = mb_substr($approach, mb_strpos($approach, <span class="stringliteral">&apos;&lt;/table:table-header-rows&gt;&apos;</span>) + mb_strlen(<span class="stringliteral">&apos;&lt;/table:table-header-rows&gt;&apos;</span>));
<a name="l00210"></a>00210 
<a name="l00211"></a>00211         <span class="keywordflow">if</span>( $which &gt; 1 )    {   <span class="comment">// drop all whats behind the end of the table&apos;s row</span>
<a name="l00212"></a>00212             <span class="keywordflow">for</span>($i = 1; $i &lt; $which; $i++)  {   <span class="comment">//here we kill first all unused rows which are before the needed one.</span>
<a name="l00213"></a>00213                 $tmpApproach    =   mb_substr($approach, 0, mb_strpos($approach, <span class="stringliteral">&apos;&lt;/table:table-row&gt;&apos;</span>)+mb_strlen(<span class="stringliteral">&apos;&lt;/table:table-row&gt;&apos;</span>));
<a name="l00214"></a>00214                 $approach       =   <a class="code" href="javascript_8js.html#a653ea8da4d112c6bce1135d086cb38c9">str_replace</a>($tmpApproach, <span class="stringliteral">&apos;&apos;</span>, $approach);
<a name="l00215"></a>00215             }
<a name="l00216"></a>00216 
<a name="l00217"></a>00217             $approach = mb_substr($approach, 0, mb_strpos($approach, <span class="stringliteral">&apos;&lt;/table:table-row&gt;&apos;</span>)+mb_strlen(<span class="stringliteral">&apos;&lt;/table:table-row&gt;&apos;</span>));
<a name="l00218"></a>00218 
<a name="l00219"></a>00219         } <span class="keywordflow">else</span> {
<a name="l00220"></a>00220             $approach = mb_substr($approach, 0, mb_strpos($approach, <span class="stringliteral">&apos;&lt;/table:table-row&gt;&apos;</span>)+mb_strlen(<span class="stringliteral">&apos;&lt;/table:table-row&gt;&apos;</span>));
<a name="l00221"></a>00221         }
<a name="l00222"></a>00222 
<a name="l00223"></a>00223         <span class="keywordflow">return</span> $approach;
<a name="l00224"></a>00224     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a269b9025a53d7214c6705b898600c8e3"></a><!-- doxytag: member="TodoyuOdt::extractTableFromDocument" ref="a269b9025a53d7214c6705b898600c8e3" args="($document, $number=1, $keepContentBeforeTable=false)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">extractTableFromDocument </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>document</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>number</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>keepContentBeforeTable</em> = <code>false</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Extracts the Given Table from the content.</p>
<p>if $keepContentBeforeTable is given. We don't extract the table from the Content before. This is used for deleting obsolete Tables in the Template.</p>
<dl><dt><b>Parameter:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>String</em>&nbsp;</td><td>$document </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Integer</em>&nbsp;</td><td>$number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Boolean</em>&nbsp;</td><td>$keepContentBeforeTable</td></tr>
  </table>
  </dd>
</dl>
<p>private </p>

<p>Definiert in Zeile <a class="el" href="_todoyu_odt_8class_8php_source.html#l00179">179</a> der Datei <a class="el" href="_todoyu_odt_8class_8php_source.html">TodoyuOdt.class.php</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00179"></a>00179                                                                                                          {
<a name="l00180"></a>00180         $approach = $document;
<a name="l00181"></a>00181 
<a name="l00182"></a>00182         <span class="comment">// Take everything whats after x table ($number)</span>
<a name="l00183"></a>00183         <span class="keywordflow">for</span>($i = 1; $i &lt; $number; $i++) {
<a name="l00184"></a>00184             $approach = mb_substr($approach, mb_strpos($approach, <span class="stringliteral">&apos;&lt;/table:table&gt;&apos;</span>)+mb_strlen(<span class="stringliteral">&apos;&lt;/table:table&gt;&apos;</span>));
<a name="l00185"></a>00185         }
<a name="l00186"></a>00186 
<a name="l00187"></a>00187         <span class="comment">// Remove everything whats before the requested table</span>
<a name="l00188"></a>00188         $approach = ($keepContentBeforeTable) ? $approach:mb_substr($approach, mb_strpos($approach, <span class="stringliteral">&apos;&lt;table:table &apos;</span>));
<a name="l00189"></a>00189 
<a name="l00190"></a>00190         <span class="keywordflow">return</span> $approach;
<a name="l00191"></a>00191     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a58e43f09a06ce4e29b192c4e17ce7915"></a><!-- doxytag: member="TodoyuOdt::getContent" ref="a58e43f09a06ce4e29b192c4e17ce7915" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getContent </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns the content of the generated odt-file</p>
<dl class="return"><dt><b>Rückgabe:</b></dt><dd>String </dd></dl>

<p>Definiert in Zeile <a class="el" href="_todoyu_odt_8class_8php_source.html#l00282">282</a> der Datei <a class="el" href="_todoyu_odt_8class_8php_source.html">TodoyuOdt.class.php</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00282"></a>00282                                     {
<a name="l00283"></a>00283         <span class="keywordflow">if</span>(! $this-&gt;tmpOdtFile) {
<a name="l00284"></a>00284             $this-&gt;<a class="code" href="class_todoyu_odt.html#ae3e046155ccc09aa7fc6eb2aa5af04d8">write</a>();
<a name="l00285"></a>00285         }
<a name="l00286"></a>00286 
<a name="l00287"></a>00287         <span class="keywordflow">return</span> file_get_contents($this-&gt;tmpOdtFile);
<a name="l00288"></a>00288     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af93f3adb8717fce28ce679a70ef5726b"></a><!-- doxytag: member="TodoyuOdt::getTemplateFileName" ref="af93f3adb8717fce28ce679a70ef5726b" args="($tmplFile)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getTemplateFileName </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>tmplFile</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns the file name of the template file</p>
<dl><dt><b>Parameter:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>String</em>&nbsp;</td><td>$tmplFile </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Rückgabe:</b></dt><dd>String </dd></dl>

<p>Definiert in Zeile <a class="el" href="_todoyu_odt_8class_8php_source.html#l00252">252</a> der Datei <a class="el" href="_todoyu_odt_8class_8php_source.html">TodoyuOdt.class.php</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00252"></a>00252                                                         {
<a name="l00253"></a>00253         $tmplFileArr = explode(<span class="charliteral">&apos;/&apos;</span>, $tmplFile);
<a name="l00254"></a>00254         <span class="keywordflow">return</span> array_pop($tmplFileArr);
<a name="l00255"></a>00255     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4be4055f3361d4800e16bc2e2e38cda6"></a><!-- doxytag: member="TodoyuOdt::init" ref="a4be4055f3361d4800e16bc2e2e38cda6" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">init </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Initializes the class </p>

<p>Definiert in Zeile <a class="el" href="_todoyu_odt_8class_8php_source.html#l00086">86</a> der Datei <a class="el" href="_todoyu_odt_8class_8php_source.html">TodoyuOdt.class.php</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00086"></a>00086                                 {
<a name="l00087"></a>00087         <span class="keywordflow">if</span>(!is_dir($this-&gt;tmpDir))  {
<a name="l00088"></a>00088             mkdir($this-&gt;tmpDir);
<a name="l00089"></a>00089         }
<a name="l00090"></a>00090 
<a name="l00091"></a>00091         $this-&gt;<a class="code" href="class_todoyu_odt.html#a840b738964f8750ed1e97b94ae3535cb">exec</a>(<span class="stringliteral">&apos;chmod -R 777 &apos;</span>.<a class="code" href="core_2config_2constants_8php.html#a493cb31434fe89068acb376025bd7c7b">PATH_CACHE</a>.<span class="stringliteral">&apos;/odt/&apos;</span>);
<a name="l00092"></a>00092 
<a name="l00093"></a>00093         $this-&gt;tmpDir   .=  <span class="charliteral">&apos;/&apos;</span>.$this-&gt;ext;
<a name="l00094"></a>00094 
<a name="l00095"></a>00095         <span class="keywordflow">if</span>(!is_dir($this-&gt;tmpDir))  {
<a name="l00096"></a>00096             mkdir($this-&gt;tmpDir);
<a name="l00097"></a>00097         }
<a name="l00098"></a>00098     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a03cb9db6e8b76566e472612d14550a05"></a><!-- doxytag: member="TodoyuOdt::openFromTemplate" ref="a03cb9db6e8b76566e472612d14550a05" args="($templateFile)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">openFromTemplate </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>templateFile</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Opens the given template file. creates the unzipped folder in the cache of not exists</p>
<dl><dt><b>Ausnahmebehandlung:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Exception</em>&nbsp;</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Parameter:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>String</em>&nbsp;</td><td>$templateFile </td></tr>
  </table>
  </dd>
</dl>

<p>Definiert in Zeile <a class="el" href="_todoyu_odt_8class_8php_source.html#l00110">110</a> der Datei <a class="el" href="_todoyu_odt_8class_8php_source.html">TodoyuOdt.class.php</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00110"></a>00110                                                     {
<a name="l00111"></a>00111         <span class="keywordflow">if</span>(! is_file($templateFile))    {
<a name="l00112"></a>00112             <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&apos;Templatefile &apos;</span>.$templateFile.<span class="stringliteral">&apos; not found!&apos;</span>);
<a name="l00113"></a>00113         }
<a name="l00114"></a>00114 
<a name="l00115"></a>00115         $unzippedDir = $this-&gt;tmpDir.<span class="charliteral">&apos;/&apos;</span>.$this-&gt;<a class="code" href="class_todoyu_odt.html#af93f3adb8717fce28ce679a70ef5726b">getTemplateFileName</a>($templateFile).<span class="stringliteral">&apos;-unzipped&apos;</span>;
<a name="l00116"></a>00116 
<a name="l00117"></a>00117         <span class="keywordflow">if</span>(! is_dir($unzippedDir)   )   {
<a name="l00118"></a>00118             mkdir($unzippedDir);
<a name="l00119"></a>00119             $this-&gt;<a class="code" href="class_todoyu_odt.html#a211a228d0801e7661acbee96a1a57df5">extractFromZip</a>($unzippedDir, $templateFile);
<a name="l00120"></a>00120         }
<a name="l00121"></a>00121 
<a name="l00122"></a>00122         <span class="keywordflow">if</span>(! $this-&gt;tmpOdtDir)  $this-&gt;tmpOdtDir = $this-&gt;tmpDir.<span class="charliteral">&apos;/&apos;</span>.substr(md5(mt_rand().microtime()), 0, 15);
<a name="l00123"></a>00123 
<a name="l00124"></a>00124         $command = <span class="stringliteral">&apos;cp -R \&apos;&apos;</span>.$unzippedDir.<span class="charliteral">&apos;\&apos;</span> \<span class="stringliteral">&apos;&apos;</span>.$this-&gt;tmpOdtDir.<span class="charliteral">&apos;\&apos;&apos;</span>;
<a name="l00125"></a>00125         $this-&gt;<a class="code" href="class_todoyu_odt.html#a840b738964f8750ed1e97b94ae3535cb">exec</a>($command);
<a name="l00126"></a>00126     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a00bf95c4d461199f209c19aa2c391564"></a><!-- doxytag: member="TodoyuOdt::replaceMarker" ref="a00bf95c4d461199f209c19aa2c391564" args="($markerName, $value, $content)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">replaceMarker </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>markerName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>content</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>replaces a single marker</p>
<dl><dt><b>Parameter:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>String</em>&nbsp;</td><td>$markerName </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>String</em>&nbsp;</td><td>$value </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>String</em>&nbsp;</td><td>$content </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Rückgabe:</b></dt><dd>String </dd></dl>

<p>Definiert in Zeile <a class="el" href="_todoyu_odt_8class_8php_source.html#l00161">161</a> der Datei <a class="el" href="_todoyu_odt_8class_8php_source.html">TodoyuOdt.class.php</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00161"></a>00161                                                                     {
<a name="l00162"></a>00162         <span class="keywordflow">return</span> <a class="code" href="javascript_8js.html#a653ea8da4d112c6bce1135d086cb38c9">str_replace</a>( <span class="stringliteral">&apos;&lt;text:placeholder text:placeholder-type=&quot;text&quot;&gt;&amp;lt;&apos;</span>.$markerName.<span class="stringliteral">&apos;&amp;gt;&lt;/text:placeholder&gt;&apos;</span> , <span class="stringliteral">&apos;&lt;![CDATA[&apos;</span>.$value.<span class="stringliteral">&apos;]]&gt;&apos;</span> , $content);
<a name="l00163"></a>00163     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac756f1b67954f30d187e1c82a38a1898"></a><!-- doxytag: member="TodoyuOdt::replaceMarkers" ref="ac756f1b67954f30d187e1c82a38a1898" args="(array $markersArray)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">replaceMarkers </td>
          <td>(</td>
          <td class="paramtype">array $&nbsp;</td>
          <td class="paramname"> <em>markersArray</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Replaces markers from markersarray -&gt; arraykey =&gt; markername -&gt; arrayvalue =&gt; markervalue</p>
<dl><dt><b>Parameter:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Array</em>&nbsp;</td><td>$markersArray </td></tr>
  </table>
  </dd>
</dl>

<p>Definiert in Zeile <a class="el" href="_todoyu_odt_8class_8php_source.html#l00137">137</a> der Datei <a class="el" href="_todoyu_odt_8class_8php_source.html">TodoyuOdt.class.php</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00137"></a>00137                                                         {
<a name="l00138"></a>00138         $content = file_get_contents($this-&gt;tmpOdtDir.<span class="stringliteral">&apos;/content.xml&apos;</span>);
<a name="l00139"></a>00139 
<a name="l00140"></a>00140         <span class="keywordflow">foreach</span>($markersArray as $markerName =&gt; $valueToReplace)    {
<a name="l00141"></a>00141             $valueToReplace = nl2br($valueToReplace);
<a name="l00142"></a>00142             $valueToReplace = preg_replace(<span class="stringliteral">&apos;/[\n\s]*&lt;br \/&gt;[\n\s]*/&apos;</span>,<span class="stringliteral">&apos;]]&gt;&lt;text:line-break/&gt;&lt;![CDATA[&apos;</span>, trim($valueToReplace));
<a name="l00143"></a>00143             $valueToReplace = <a class="code" href="javascript_8js.html#a653ea8da4d112c6bce1135d086cb38c9">str_replace</a>(<span class="stringliteral">&apos;&amp;nbsp;&apos;</span>,<span class="charliteral">&apos; &apos;</span>,$valueToReplace);
<a name="l00144"></a>00144 
<a name="l00145"></a>00145             $content = $this-&gt;<a class="code" href="class_todoyu_odt.html#a00bf95c4d461199f209c19aa2c391564">replaceMarker</a>($markerName, $valueToReplace, $content);
<a name="l00146"></a>00146         }
<a name="l00147"></a>00147 
<a name="l00148"></a>00148         file_put_contents($this-&gt;tmpOdtDir.<span class="stringliteral">&apos;/content.xml&apos;</span>, $content);
<a name="l00149"></a>00149     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae3e046155ccc09aa7fc6eb2aa5af04d8"></a><!-- doxytag: member="TodoyuOdt::write" ref="ae3e046155ccc09aa7fc6eb2aa5af04d8" args="($odtPath=null)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">write </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>odtPath</em> = <code>null</code></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Creates the temporary file and compresses the odt-folder again</p>
<dl><dt><b>Parameter:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>String</em>&nbsp;</td><td>$odtPath </td></tr>
  </table>
  </dd>
</dl>

<p>Definiert in Zeile <a class="el" href="_todoyu_odt_8class_8php_source.html#l00264">264</a> der Datei <a class="el" href="_todoyu_odt_8class_8php_source.html">TodoyuOdt.class.php</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00264"></a>00264                                             {
<a name="l00265"></a>00265         <span class="keywordflow">if</span>(! $this-&gt;tmpOdtFile) $this-&gt;tmpOdtFile = mb_substr($this-&gt;tmpOdtDir, 0, -1).<span class="stringliteral">&apos;.odt&apos;</span>;
<a name="l00266"></a>00266 
<a name="l00267"></a>00267         $this-&gt;<a class="code" href="class_todoyu_odt.html#ac97c6499e6c8221c2199651017d9cefe">compressToZip</a>($this-&gt;tmpOdtFile, $this-&gt;tmpOdtDir);
<a name="l00268"></a>00268 
<a name="l00269"></a>00269         <span class="keywordflow">if</span>( $odtPath ) {
<a name="l00270"></a>00270             $command = <span class="stringliteral">&apos;cp &apos;</span>.$this-&gt;tmpOdtFile.<span class="charliteral">&apos; &apos;</span>.$odtPath;
<a name="l00271"></a>00271             $this-&gt;<a class="code" href="class_todoyu_odt.html#a840b738964f8750ed1e97b94ae3535cb">exec</a>($command);
<a name="l00272"></a>00272         }
<a name="l00273"></a>00273     }
</pre></div></p>

</div>
</div>
<hr/><h2>Dokumentation der Datenelemente</h2>
<a class="anchor" id="ade30ae71930839daaf6f83bd19081493"></a><!-- doxytag: member="TodoyuOdt::$ext" ref="ade30ae71930839daaf6f83bd19081493" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$ext<code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definiert in Zeile <a class="el" href="_todoyu_odt_8class_8php_source.html#l00062">62</a> der Datei <a class="el" href="_todoyu_odt_8class_8php_source.html">TodoyuOdt.class.php</a>.</p>

</div>
</div>
<a class="anchor" id="aee4c6edab40be8352c6f5aa453437f6b"></a><!-- doxytag: member="TodoyuOdt::$tmpDir" ref="aee4c6edab40be8352c6f5aa453437f6b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$tmpDir<code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definiert in Zeile <a class="el" href="_todoyu_odt_8class_8php_source.html#l00035">35</a> der Datei <a class="el" href="_todoyu_odt_8class_8php_source.html">TodoyuOdt.class.php</a>.</p>

</div>
</div>
<a class="anchor" id="a42cf7a1034adc5fef0c8d89f6300189d"></a><!-- doxytag: member="TodoyuOdt::$tmpOdtDir" ref="a42cf7a1034adc5fef0c8d89f6300189d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$tmpOdtDir<code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definiert in Zeile <a class="el" href="_todoyu_odt_8class_8php_source.html#l00044">44</a> der Datei <a class="el" href="_todoyu_odt_8class_8php_source.html">TodoyuOdt.class.php</a>.</p>

</div>
</div>
<a class="anchor" id="a236ef5b2a05f6aac010d313fec700d97"></a><!-- doxytag: member="TodoyuOdt::$tmpOdtFile" ref="a236ef5b2a05f6aac010d313fec700d97" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$tmpOdtFile<code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definiert in Zeile <a class="el" href="_todoyu_odt_8class_8php_source.html#l00053">53</a> der Datei <a class="el" href="_todoyu_odt_8class_8php_source.html">TodoyuOdt.class.php</a>.</p>

</div>
</div>
<hr/>Die Dokumentation für diese Klasse wurde erzeugt aufgrund der Datei:<ul>
<li>C:/Programme/xampp/htdocs/todoyu2/core/<a class="el" href="_todoyu_odt_8class_8php_source.html">TodoyuOdt.class.php</a></li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>Erzeugt am Tue Dec 1 18:32:46 2009 für Todoyu von&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
